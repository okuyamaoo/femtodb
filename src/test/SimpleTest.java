package test;import java.util.*;import femtodb.core.*;import femtodb.core.table.*;import femtodb.core.table.transaction.*;import femtodb.core.table.data.*;import femtodb.core.table.type.*;import femtodb.core.accessor.*;import femtodb.core.accessor.parameter.*;public class SimpleTest {    DataAccessor ac = null;    public static void main(String[] args) {        try {            SimpleTest test = new SimpleTest();            test.ac = new DataAccessor(args);            System.out.println("Simple test start");            System.out.println(" testCreateTable - start");            test.testCreateTable();            System.out.println(" testCreateTable - end");            System.out.println(" insert - start");            test.testInsert();            System.out.println(" insert - end");            System.out.println(" update - start");            test.testUpdate();            System.out.println(" update - end");            System.out.println(" delete - start");            test.testDelete();            System.out.println(" delete - end");            System.out.println("Simple test finish");            System.exit(0);        } catch(Exception e) {            e.printStackTrace();        }    }    public void testCreateTable() throws Exception {                TableInfo tbl1 = new TableInfo("table1");        TableInfo tbl2 = new TableInfo("table2");        TableInfo tbl3 = new TableInfo("table1");        tbl1.addTableColumnInfo("table1-column1", new ColumnTypeVarchar());        tbl1.addTableColumnInfo("table1-column2", new ColumnTypeText());        if (ac.createTable(tbl1) != 1) System.out.println(" testCreateTable - error - 1");        tbl2.addTableColumnInfo("table2-column1", new ColumnTypeText());        tbl2.addTableColumnInfo("table2-column2", new ColumnTypeVarchar());        if (ac.createTable(tbl2) != 1) System.out.println(" testCreateTable - error - 2");        if (ac.createTable(tbl3) == 1) System.out.println(" testCreateTable - error - 3");        List<TableInfo> tableList = ac.getTableList();        if (tableList == null || tableList.size() != 2)  System.out.println(" testCreateTable - error - 4");        for (TableInfo info : tableList) {            if (!info.tableName.equals("table1") && !info.tableName.equals("table2")) System.out.println(" testCreateTable - error - 5");        }        for (TableInfo info : tableList) {            if (info.tableName.equals("table1")) {                Iterator ite = info.infomationMap.entrySet().iterator();                int cnt = 0;                while(ite.hasNext()) {                    cnt++;                    Map.Entry<String, IColumnType> targetEntry = (Map.Entry)ite.next();                    String key = targetEntry.getKey();                    IColumnType value = targetEntry.getValue();                    if (key.equals("table1-column1")) {                        if (value.getType() != 1) {                            System.out.println(" testCreateTable - error - 6");                        }                    } else if (key.equals("table1-column2")) {                        if (value.getType() != 3) {                            System.out.println(" testCreateTable - error - 7");                        }                    } else {                        System.out.println(" testCreateTable - error - 8");                    }                 }                if (cnt != 2) System.out.println(" testCreateTable - error - 9");            } else if (info.tableName.equals("table2")) {                Iterator ite = info.infomationMap.entrySet().iterator();                int cnt = 0;                while(ite.hasNext()) {                    cnt++;                    Map.Entry<String, IColumnType> targetEntry = (Map.Entry)ite.next();                    String key = targetEntry.getKey();                    IColumnType value = targetEntry.getValue();                    if (key.equals("table2-column1")) {                        if (value.getType() != 3) {                            System.out.println(" testCreateTable - error - 10");                        }                    } else if (key.equals("table2-column2")) {                        if (value.getType() != 1) {                            System.out.println(" testCreateTable - error - 11");                        }                    } else {                        System.out.println(" testCreateTable - error - 12");                    }                 }                if (cnt != 2) System.out.println(" testCreateTable - error - 13");            }        }    }    public void testInsert() throws Exception {        String tableName = "inserttable";        TableInfo tbl = new TableInfo(tableName);        tbl.addTableColumnInfo("col1", new ColumnTypeVarchar());        tbl.addTableColumnInfo("col2", new ColumnTypeVarchar());        ac.createTable(tbl);        TransactionNo tn1 = ac.createTransaction();        TransactionNo tn2 = ac.createTransaction();        TableDataTransfer tableDataTransfer1 = new TableDataTransfer();        tableDataTransfer1.setTransactionNo(tn1);        tableDataTransfer1.setColumnData("col1", "col1-1data");        tableDataTransfer1.setColumnData("col2", "col2-1data");        tableDataTransfer1.setColumnData("col3", "col3-1data");        tableDataTransfer1.setColumnData("col4", "15");        ac.insertTableData(tableName, tn1, tableDataTransfer1);        TableDataTransfer tableDataTransfer2 = new TableDataTransfer();        tableDataTransfer2.setTransactionNo(tn1);        tableDataTransfer2.setColumnData("col1", "col1-2data");        tableDataTransfer2.setColumnData("col2", "col2-2data");        tableDataTransfer2.setColumnData("col3", "col3-2data");        tableDataTransfer2.setColumnData("col4", "40");        ac.insertTableData(tableName, tn1, tableDataTransfer2);        SelectParameter sp1 = new SelectParameter();        sp1.setTableName(tableName);        List<TableDataTransfer> ret1 = ac.selectTableDataList(sp1, tn1);        if (ret1.size() == 2) {            for (TableDataTransfer tableDataTransfer : ret1) {                if (tableDataTransfer.getColumnData("col1") != null &&                         (tableDataTransfer.getColumnData("col1").equals("col1-2data") || tableDataTransfer.getColumnData("col1").equals("col1-1data"))) {                    if (tableDataTransfer.getColumnData("col1").equals("col1-1data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("15")) {                            System.out.println(" testInsert - error - 1");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-1data")) {                            System.out.println(" testInsert - error - 2");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-1data")) {                            System.out.println(" testInsert - error - 3");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-1data")) {                            System.out.println(" testInsert - error - 4");                        }                    } else if (tableDataTransfer.getColumnData("col1").equals("col1-2data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("40")) {                            System.out.println(" testInsert - error - 5");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-2data")) {                            System.out.println(" testInsert - error - 6");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-2data")) {                            System.out.println(" testInsert - error - 7");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-2data")) {                            System.out.println(" testInsert - error - 8");                        }                    } else {                        System.out.println(" testInsert - error - 9");                    }                } else {                    System.out.println(" testInsert - error - 10");                }            }        } else {            System.out.println(" testInsert - error - 11");        }        TableDataTransfer tableDataTransfer3 = new TableDataTransfer();        tableDataTransfer3.setTransactionNo(tn2);        tableDataTransfer3.setColumnData("col1", "col1-3data");        tableDataTransfer3.setColumnData("col2", "col2-3data");        tableDataTransfer3.setColumnData("col3", "col3-3data");        tableDataTransfer3.setColumnData("col4", "60");        ac.insertTableData(tableName, tn2, tableDataTransfer3);        TableDataTransfer tableDataTransfer4 = new TableDataTransfer();        tableDataTransfer4.setTransactionNo(tn2);        tableDataTransfer4.setColumnData("col1", "col1-4data");        tableDataTransfer4.setColumnData("col2", "col2-4data");        tableDataTransfer4.setColumnData("col3", "col3-4data");        tableDataTransfer4.setColumnData("col4", "70");        ac.insertTableData(tableName, tn2, tableDataTransfer4);        sp1 = new SelectParameter();        sp1.setTableName(tableName);        ret1 = ac.selectTableDataList(sp1, tn1);        if (ret1.size() == 2) {            for (TableDataTransfer tableDataTransfer : ret1) {                if (tableDataTransfer.getColumnData("col1") != null &&                         (tableDataTransfer.getColumnData("col1").equals("col1-2data") || tableDataTransfer.getColumnData("col1").equals("col1-1data"))) {                    if (tableDataTransfer.getColumnData("col1").equals("col1-1data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("15")) {                            System.out.println(" testInsert - error - 1");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-1data")) {                            System.out.println(" testInsert - error - 2");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-1data")) {                            System.out.println(" testInsert - error - 3");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-1data")) {                            System.out.println(" testInsert - error - 4");                        }                    } else if (tableDataTransfer.getColumnData("col1").equals("col1-2data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("40")) {                            System.out.println(" testInsert - error - 5");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-2data")) {                            System.out.println(" testInsert - error - 6");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-2data")) {                            System.out.println(" testInsert - error - 7");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-2data")) {                            System.out.println(" testInsert - error - 8");                        }                    } else {                        System.out.println(" testInsert - error - 9");                    }                } else {                    System.out.println(" testInsert - error - 10");                }            }        } else {            System.out.println(" testInsert - error - 11");        }        SelectParameter sp2 = new SelectParameter();        sp2.setTableName(tableName);        ret1 = ac.selectTableDataList(sp2, tn2);        if (ret1.size() == 2) {            for (TableDataTransfer tableDataTransfer : ret1) {                if (tableDataTransfer.getColumnData("col1") != null &&                         (tableDataTransfer.getColumnData("col1").equals("col1-3data") || tableDataTransfer.getColumnData("col1").equals("col1-4data"))) {                    if (tableDataTransfer.getColumnData("col1").equals("col1-3data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("60")) {                            System.out.println(" testInsert - error - 12");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-3data")) {                            System.out.println(" testInsert - error - 13");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-3data")) {                            System.out.println(" testInsert - error - 15");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-3data")) {                            System.out.println(" testInsert - error - 16");                        }                    } else if (tableDataTransfer.getColumnData("col1").equals("col1-4data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("70")) {                            System.out.println(" testInsert - error - 17");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-4data")) {                            System.out.println(" testInsert - error - 18");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-4data")) {                            System.out.println(" testInsert - error - 19");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-4data")) {                            System.out.println(" testInsert - error - 20");                        }                    } else {                        System.out.println(" testInsert - error - 21");                    }                } else {                    System.out.println(" testInsert - error - 22");                }            }        } else {            System.out.println(" testInsert - error - 23");        }        ac.commitTransaction(tn1);        sp2 = new SelectParameter();        sp2.setTableName(tableName);        ret1 = ac.selectTableDataList(sp2, tn2);        if (ret1.size() == 4) {            for (TableDataTransfer tableDataTransfer : ret1) {                if (tableDataTransfer.getColumnData("col1") != null &&                         (tableDataTransfer.getColumnData("col1").equals("col1-1data") || tableDataTransfer.getColumnData("col1").equals("col1-2data") ||                         tableDataTransfer.getColumnData("col1").equals("col1-3data") || tableDataTransfer.getColumnData("col1").equals("col1-4data"))) {                    if (tableDataTransfer.getColumnData("col1").equals("col1-1data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("15")) {                            System.out.println(" testInsert - error - 24");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-1data")) {                            System.out.println(" testInsert - error - 25");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-1data")) {                            System.out.println(" testInsert - error - 26");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-1data")) {                            System.out.println(" testInsert - error - 27");                        }                    } else if (tableDataTransfer.getColumnData("col1").equals("col1-2data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("40")) {                            System.out.println(" testInsert - error - 28");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-2data")) {                            System.out.println(" testInsert - error - 29");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-2data")) {                            System.out.println(" testInsert - error - 30");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-2data")) {                            System.out.println(" testInsert - error - 31");                        }                     } else if (tableDataTransfer.getColumnData("col1").equals("col1-3data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("60")) {                            System.out.println(" testInsert - error - 32");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-3data")) {                            System.out.println(" testInsert - error - 33");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-3data")) {                            System.out.println(" testInsert - error - 34");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-3data")) {                            System.out.println(" testInsert - error - 35");                        }                    } else if (tableDataTransfer.getColumnData("col1").equals("col1-4data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("70")) {                            System.out.println(" testInsert - error - 36");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-4data")) {                            System.out.println(" testInsert - error - 37");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-4data")) {                            System.out.println(" testInsert - error - 38");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-4data")) {                            System.out.println(" testInsert - error - 39");                        }                    } else {                        System.out.println(" testInsert - error - 40");                    }                } else {                    System.out.println(" testInsert - error - 41");                }            }        } else {            System.out.println(" testInsert - error - 42");        }        TransactionNo tn3 = ac.createTransaction();        sp2 = new SelectParameter();        sp2.setTableName(tableName);        ret1 = ac.selectTableDataList(sp2, tn3);        if (ret1.size() == 2) {            for (TableDataTransfer tableDataTransfer : ret1) {                if (tableDataTransfer.getColumnData("col1") != null &&                         (tableDataTransfer.getColumnData("col1").equals("col1-2data") || tableDataTransfer.getColumnData("col1").equals("col1-1data"))) {                    if (tableDataTransfer.getColumnData("col1").equals("col1-1data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("15")) {                            System.out.println(" testInsert - error - 43");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-1data")) {                            System.out.println(" testInsert - error - 44");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-1data")) {                            System.out.println(" testInsert - error - 45");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-1data")) {                            System.out.println(" testInsert - error - 46");                        }                    } else if (tableDataTransfer.getColumnData("col1").equals("col1-2data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("40")) {                            System.out.println(" testInsert - error - 47");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-2data")) {                            System.out.println(" testInsert - error - 48");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-2data")) {                            System.out.println(" testInsert - error - 49");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-2data")) {                            System.out.println(" testInsert - error - 50");                        }                    } else {                        System.out.println(" testInsert - error - 51");                    }                } else {                    System.out.println(" testInsert - error - 52");                }            }        } else {            System.out.println(" testInsert - error - 53");        }        ac.commitTransaction(tn2);        sp2 = new SelectParameter();        sp2.setTableName(tableName);        ret1 = ac.selectTableDataList(sp2, tn3);        if (ret1.size() == 4) {            for (TableDataTransfer tableDataTransfer : ret1) {                if (tableDataTransfer.getColumnData("col1") != null &&                         (tableDataTransfer.getColumnData("col1").equals("col1-1data") || tableDataTransfer.getColumnData("col1").equals("col1-2data") ||                         tableDataTransfer.getColumnData("col1").equals("col1-3data") || tableDataTransfer.getColumnData("col1").equals("col1-4data"))) {                    if (tableDataTransfer.getColumnData("col1").equals("col1-1data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("15")) {                            System.out.println(" testInsert - error - 54");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-1data")) {                            System.out.println(" testInsert - error - 55");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-1data")) {                            System.out.println(" testInsert - error - 56");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-1data")) {                            System.out.println(" testInsert - error - 57");                        }                    } else if (tableDataTransfer.getColumnData("col1").equals("col1-2data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("40")) {                            System.out.println(" testInsert - error - 58");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-2data")) {                            System.out.println(" testInsert - error - 59");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-2data")) {                            System.out.println(" testInsert - error - 60");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-2data")) {                            System.out.println(" testInsert - error - 61");                        }                     } else if (tableDataTransfer.getColumnData("col1").equals("col1-3data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("60")) {                            System.out.println(" testInsert - error - 62");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-3data")) {                            System.out.println(" testInsert - error - 63");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-3data")) {                            System.out.println(" testInsert - error - 64");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-3data")) {                            System.out.println(" testInsert - error - 65");                        }                    } else if (tableDataTransfer.getColumnData("col1").equals("col1-4data")) {                        if (!tableDataTransfer.getColumnData("col4").equals("70")) {                            System.out.println(" testInsert - error - 66");                        }                        if (!tableDataTransfer.getColumnData("col1").equals("col1-4data")) {                            System.out.println(" testInsert - error - 67");                        }                        if (!tableDataTransfer.getColumnData("col2").equals("col2-4data")) {                            System.out.println(" testInsert - error - 68");                        }                        if (!tableDataTransfer.getColumnData("col3").equals("col3-4data")) {                            System.out.println(" testInsert - error - 69");                        }                    } else {                        System.out.println(" testInsert - error - 70");                    }                } else {                    System.out.println(" testInsert - error - 71");                }            }        } else {            System.out.println(" testInsert - error - 72");        }    }    public void testUpdate() throws Exception {        String tableName = "updatetable";        TableInfo tbl = new TableInfo(tableName);        tbl.addTableColumnInfo("col1", new ColumnTypeVarchar());        tbl.addTableColumnInfo("col2", new ColumnTypeVarchar());        tbl.addTableColumnInfo("col9", new ColumnTypeVarchar());        ac.createTable(tbl);        TransactionNo tn1 = ac.createTransaction();        TableDataTransfer tableDataTransfer1 = new TableDataTransfer();        tableDataTransfer1.setTransactionNo(tn1);        tableDataTransfer1.setColumnData("col1", "col1-1data");        tableDataTransfer1.setColumnData("col2", "col2-1data");        tableDataTransfer1.setColumnData("col3", "col3-1data");        tableDataTransfer1.setColumnData("col4", "15");        tableDataTransfer1.setColumnData("col9", "col9-1data");        ac.insertTableData(tableName, tn1, tableDataTransfer1);        TableDataTransfer tableDataTransfer2 = new TableDataTransfer();        tableDataTransfer2.setTransactionNo(tn1);        tableDataTransfer2.setColumnData("col1", "col1-2data");        tableDataTransfer2.setColumnData("col2", "col2-2data");        tableDataTransfer2.setColumnData("col3", "col3-2data");        tableDataTransfer2.setColumnData("col4", "40");        tableDataTransfer2.setColumnData("col9", "col9-1data");        ac.insertTableData(tableName, tn1, tableDataTransfer2);        TableDataTransfer tableDataTransfer3 = new TableDataTransfer();        tableDataTransfer3.setTransactionNo(tn1);        tableDataTransfer3.setColumnData("col1", "col1-2data");        tableDataTransfer3.setColumnData("col2", "col2-2data");        tableDataTransfer3.setColumnData("col3", "col3-2data");        tableDataTransfer3.setColumnData("col4", "40");        tableDataTransfer3.setColumnData("col9", "col9-11data");        ac.insertTableData(tableName, tn1, tableDataTransfer3);        ac.commitTransaction(tn1);        TransactionNo tn2 = ac.createTransaction();        UpdateParameter up1 = new UpdateParameter();        up1.setTableName(tableName);        up1.setUpdateParameter("col4", new StringUpdateParameter("999"));        int updateRet = ac.updateTableData(up1, tn2);        if (updateRet != 3) System.out.println(" testUpdate - error - 1");        SelectParameter sp1 = new SelectParameter();        sp1.setTableName(tableName);        sp1.addNormalWhereParameter("col4", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("999"));        List<TableDataTransfer> ret1 = ac.selectTableDataList(sp1, tn2);        if (ret1.size() != 3) {            System.out.println(" testUpdate - error - 2");        }        up1 = new UpdateParameter();        up1.setTableName(tableName);        up1.setUpdateParameter("col9", new StringUpdateParameter("888"));        up1.addNormalWhereParameter("col4", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("999"));        updateRet = ac.updateTableData(up1, tn2);        if (updateRet != 3) System.out.println(" testUpdate - error - 4");        sp1 = new SelectParameter();        sp1.setTableName(tableName);        sp1.addNormalWhereParameter("col9", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("888"));        ret1 = ac.selectTableDataList(sp1, tn2);        if (ret1.size() != 3) {            System.out.println(" testUpdate - error - 5");        }        TransactionNo tn3 = ac.createTransaction();        sp1 = new SelectParameter();        sp1.setTableName(tableName);        sp1.setIndexWhereParameter("col9", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("888"));        ret1 = ac.selectTableDataList(sp1, tn3);        if (ret1.size() != 0) {            System.out.println(" testUpdate - error - 6");        }        sp1 = new SelectParameter();        sp1.setTableName(tableName);        sp1.addNormalWhereParameter("col4", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("999"));        ret1 = ac.selectTableDataList(sp1, tn3);        if (ret1.size() != 0) {            System.out.println(" testUpdate - error - 7");        }        ac.commitTransaction(tn2);                        tn3 = ac.createTransaction();        sp1 = new SelectParameter();        sp1.setTableName(tableName);        sp1.setIndexWhereParameter("col9", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("888"));        ret1 = ac.selectTableDataList(sp1, tn3);        if (ret1.size() != 3) {            System.out.println(" testUpdate - error - 8");        }        sp1 = new SelectParameter();        sp1.setTableName(tableName);        sp1.addNormalWhereParameter("col4", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("999"));        ret1 = ac.selectTableDataList(sp1, tn3);        if (ret1.size() != 3) {            System.out.println(" testUpdate - error - 9");        }        String tableName2 = "updatetable2";        TableInfo tbl2 = new TableInfo(tableName2);        tbl2.addTableColumnInfo("col1", new ColumnTypeVarchar());        tbl2.addTableColumnInfo("col2", new ColumnTypeVarchar());        tbl2.addTableColumnInfo("col4", new ColumnTypeVarchar());        ac.createTable(tbl2);        TransactionNo tnX0 = ac.createTransaction();        for (int i = 0; i < 100; i++) {            TableDataTransfer tableDataTransferX0 = new TableDataTransfer();            tableDataTransferX0.setTransactionNo(tnX0);            tableDataTransferX0.setColumnData("col1", "col1-1data"+i);            tableDataTransferX0.setColumnData("col2", "col2-1data"+i);            tableDataTransferX0.setColumnData("col3", new Integer(i).toString());            tableDataTransferX0.setColumnData("col4", new Integer(i).toString());            tableDataTransferX0.setColumnData("col5", new Integer(i).toString());            ac.insertTableData(tableName2, tnX0, tableDataTransferX0);        }        ac.commitTransaction(tnX0);        TransactionNo tnX1 = ac.createTransaction();        TransactionNo tnX2 = ac.createTransaction();        TransactionNo tnX3 = ac.createTransaction();        TransactionNo tnX4 = ac.createTransaction();        UpdateParameter upX = new UpdateParameter();        upX.setTableName(tableName2);        upX.setIndexWhereParameter("col1", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("col1-1data15"));        upX.setUpdateParameter("col4", new StringUpdateParameter("XXX"));        int updateRetX = ac.updateTableData(upX, tnX1);        if (updateRetX != 1) System.out.println(" testUpdate - error - 10");        try {            upX = new UpdateParameter();            upX.setTableName(tableName2);            upX.setIndexWhereParameter("col1", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("col1-1data15"));            upX.setUpdateParameter("col4", new StringUpdateParameter("XXX"));            upX.setUpdateParameter("colx", new StringUpdateParameter("XXX"));            updateRetX = ac.updateTableData(upX, tnX2);            System.out.println(" testUpdate - error - 11");        } catch (Exception e) {        }        try {            upX = new UpdateParameter();            upX.setTableName(tableName2);            upX.setIndexWhereParameter("col1", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("col1-1data15"));            upX.setUpdateParameter("col4", new StringUpdateParameter("YYY"));            upX.setUpdateParameter("colx", new StringUpdateParameter("YYY"));            updateRetX = ac.updateTableData(upX, tnX1);            if (updateRetX != 1) System.out.println(" testUpdate - error - 12");        } catch (Exception e) {            System.out.println(" testUpdate - error - 13");        }        try {            upX = new UpdateParameter();            upX.setTableName(tableName2);            upX.setIndexWhereParameter("col1", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("col1-1data16"));            upX.setUpdateParameter("col4", new StringUpdateParameter("CCCC"));            upX.setUpdateParameter("colx", new StringUpdateParameter("CCCC"));            updateRetX = ac.updateTableData(upX, tnX3);            if (updateRetX != 1) System.out.println(" testUpdate - error - 14");        } catch (Exception e) {            System.out.println(" testUpdate - error - 15");        }        try {            upX = new UpdateParameter();            upX.setTableName(tableName2);            upX.addNormalWhereParameter("col4", IWhereType.WHERE_TYPE_LARGE, new LargeWhereParameter("90"));            upX.setUpdateParameter("col4", new StringUpdateParameter("PPPP"));            upX.setUpdateParameter("colx", new StringUpdateParameter("PPPP"));            updateRetX = ac.updateTableData(upX, tnX4);            if (updateRetX != 9) System.out.println(" testUpdate - error - 16");        } catch (Exception e) {            System.out.println(" testUpdate - error - 17");        }        ac.commitTransaction(tnX1);        ac.commitTransaction(tnX3);        ac.commitTransaction(tnX4);        TransactionNo tnX5 = ac.createTransaction();        SelectParameter sp = new SelectParameter();        sp.setTableName(tableName2);        ResultStruct result = ac.selectTableData(sp, tnX5);        if (result.getBaseResultCount() != 100) {            System.out.println(" testUpdate - error - 18");        }        sp = new SelectParameter();        sp.setTableName(tableName2);        sp.setIndexWhereParameter("col1", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("col1-1data15"));        result = ac.selectTableData(sp, tnX5);                List<TableDataTransfer> list = result.getResultList();        if (list.size() != 1) {            System.out.println(" testUpdate - error - 19");        }        for (TableDataTransfer tableDataTransfer : list) {            String col4Data = tableDataTransfer.getColumnData("col4");            String colxData = tableDataTransfer.getColumnData("colx");            if (!col4Data.equals("YYY") || !colxData.equals("YYY")) {                System.out.println(" testUpdate - error - 20");            }        }        sp = new SelectParameter();        sp.setTableName(tableName2);        sp.setIndexWhereParameter("col4", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("YYY"));        result = ac.selectTableData(sp, tnX5);                list = result.getResultList();        if (list.size() != 1) {            System.out.println(" testUpdate - error - 21");        }        for (TableDataTransfer tableDataTransfer : list) {            String col1Data = tableDataTransfer.getColumnData("col1");            if (!col1Data.equals("col1-1data15")) {                System.out.println(" testUpdate - error - 22");            }        }        sp = new SelectParameter();        sp.setTableName(tableName2);        sp.setIndexWhereParameter("col1", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("col1-1data16"));        result = ac.selectTableData(sp, tnX5);                list = result.getResultList();        if (list.size() != 1) {            System.out.println(" testUpdate - error - 23");        }        for (TableDataTransfer tableDataTransfer : list) {            String col4Data = tableDataTransfer.getColumnData("col4");            String colxData = tableDataTransfer.getColumnData("colx");            if (!col4Data.equals("CCCC") || !colxData.equals("CCCC")) {                System.out.println(" testUpdate - error - 24");            }        }        sp = new SelectParameter();        sp.setTableName(tableName2);        sp.addNormalWhereParameter("colx", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("CCCC"));        result = ac.selectTableData(sp, tnX5);                list = result.getResultList();        if (list.size() != 1) {            System.out.println(" testUpdate - error - 25");        }        for (TableDataTransfer tableDataTransfer : list) {            String col1Data = tableDataTransfer.getColumnData("col1");            if (!col1Data.equals("col1-1data16")) {                System.out.println(" testUpdate - error - 26");            }        }        sp = new SelectParameter();        sp.setTableName(tableName2);        sp.setIndexWhereParameter("col4", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("PPPP"));        sp.addNormalWhereParameter("colx", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("PPPP"));        result = ac.selectTableData(sp, tnX5);                list = result.getResultList();        if (list.size() != 9) {            System.out.println(" testUpdate - error - 27");        }        for (TableDataTransfer tableDataTransfer : list) {            String col5Data = tableDataTransfer.getColumnData("col5");            if (new Integer(col5Data).intValue() < 91) {                System.out.println(" testUpdate - error - 28");            }        }    }    public void testDelete() throws Exception {        String tableName1 = "deletetable1";        TableInfo tbl1 = new TableInfo(tableName1);        tbl1.addTableColumnInfo("col1", new ColumnTypeVarchar());        tbl1.addTableColumnInfo("col2", new ColumnTypeText());        ac.createTable(tbl1);        String tableName2 = "deletetable2";        TableInfo tbl2 = new TableInfo(tableName2);        tbl2.addTableColumnInfo("col1", new ColumnTypeVarchar());        tbl2.addTableColumnInfo("col2", new ColumnTypeText());        ac.createTable(tbl2);        TransactionNo tn1 = ac.createTransaction();        TransactionNo tn2 = ac.createTransaction();        for (int i = 0; i < 100; i++) {            TableDataTransfer tableDataTransfer = new TableDataTransfer();            tableDataTransfer.setTransactionNo(tn1);            tableDataTransfer.setColumnData("col1", "col1data" + i);            tableDataTransfer.setColumnData("col2", "col2data" + i);            tableDataTransfer.setColumnData("col3", "col3data" + i);            tableDataTransfer.setColumnData("col4", new Integer(i).toString());            ac.insertTableData(tableName1, tn1, tableDataTransfer);        }        for (int i = 0; i < 100; i++) {            TableDataTransfer tableDataTransfer = new TableDataTransfer();            tableDataTransfer.setTransactionNo(tn2);            tableDataTransfer.setColumnData("col1", "col1data" + i);            tableDataTransfer.setColumnData("col2", "col2data" + i);            tableDataTransfer.setColumnData("col3", "col3data" + i);            tableDataTransfer.setColumnData("col4", new Integer(i).toString());            ac.insertTableData(tableName2, tn2, tableDataTransfer);        }        ac.commitTransaction(tn1);        ac.commitTransaction(tn2);        TransactionNo tn3 = ac.createTransaction();        TransactionNo tn4 = ac.createTransaction();        DeleteParameter deleteParameter1 = new DeleteParameter();        deleteParameter1.setTableName(tableName1);        deleteParameter1.setIndexWhereParameter("col1", IWhereType.WHERE_TYPE_EQUAL, new EqualWhereParameter("col1data10"));        int deleteRet = ac.deleteTableData(deleteParameter1, tn3);        if (deleteRet != 1) {            System.out.println(" testDelete - error - 1");        }        TransactionNo tnXX = ac.createTransaction();        SelectParameter sp = new SelectParameter();        sp.setTableName(tableName1);        ResultStruct result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 100) {            System.out.println(" testDelete - error - 2");        }        sp = new SelectParameter();        sp.setTableName(tableName2);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 100) {            System.out.println(" testDelete - error - 3");        }        if (!ac.commitTransaction(tn3)) {            System.out.println(" testDelete - error - 4");        }        sp = new SelectParameter();        sp.setTableName(tableName1);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 99) {            System.out.println(" testDelete - error - 5");        }        sp = new SelectParameter();        sp.setTableName(tableName2);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 100) {            System.out.println(" testDelete - error - 6");        }        DeleteParameter deleteParameter2 = new DeleteParameter();        deleteParameter2.setTableName(tableName2);        deleteParameter2.setIndexWhereParameter("col2", IWhereType.WHERE_TYPE_LIKE, new LikeWhereParameter("col2data9"));        deleteRet = ac.deleteTableData(deleteParameter2, tn4);        if (deleteRet != 11) {            System.out.println(" testDelete - error - 7");        }        sp = new SelectParameter();        sp.setTableName(tableName1);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 99) {            System.out.println(" testDelete - error - 8");        }        sp = new SelectParameter();        sp.setTableName(tableName2);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 100) {            System.out.println(" testDelete - error - 9");        }        if (!ac.commitTransaction(tn4)) {            System.out.println(" testDelete - error - 10");        }        sp = new SelectParameter();        sp.setTableName(tableName1);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 99) {            System.out.println(" testDelete - error - 11");        }        sp = new SelectParameter();        sp.setTableName(tableName2);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 89) {            System.out.println(" testDelete - error - 12");        }        TransactionNo tn5 = ac.createTransaction();        DeleteParameter deleteParameter3 = new DeleteParameter();        deleteParameter3.setTableName(tableName1);        deleteParameter3.setIndexWhereParameter("col4", IWhereType.WHERE_TYPE_SMALL, new SmallWhereParameter("12"));        deleteRet = ac.deleteTableData(deleteParameter3, tn5);        if (deleteRet != 11) {            System.out.println(" testDelete - error - 13");        }        sp = new SelectParameter();        sp.setTableName(tableName1);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 99) {            System.out.println(" testDelete - error - 14");        }        sp = new SelectParameter();        sp.setTableName(tableName2);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 89) {            System.out.println(" testDelete - error - 15");        }        if (!ac.commitTransaction(tn5)) {            System.out.println(" testDelete - error - 16");        }        sp = new SelectParameter();        sp.setTableName(tableName1);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 88) {            System.out.println(" testDelete - error - 17");        }        sp = new SelectParameter();        sp.setTableName(tableName2);        result = ac.selectTableData(sp, tnXX);                if (result.getBaseResultCount() != 89) {            System.out.println(" testDelete - error - 18");        }    }}