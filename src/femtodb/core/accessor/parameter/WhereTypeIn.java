package femtodb.core.accessor.parameter;import java.util.*;import femtodb.core.*;import femtodb.core.table.*;import femtodb.core.table.data.*;import femtodb.core.table.transaction.*;import femtodb.core.accessor.parameter.*;import femtodb.core.accessor.executor.*;import femtodb.core.accessor.scripts.*;/**  * WhereTypeInクラス<br> * * @author Takahiro Iwase * @license Apache License 2.0  */public class WhereTypeIn implements IWhereType {    private String whereParamStr = null;    private String[] whereParamList = null;    private String columnName = null;    public WhereTypeIn(String columnName, IWhereParameter whereParameter) {        this.columnName = columnName;        whereParamStr = whereParameter.toString();        whereParamList = whereParamStr.split(",");        for (int idx = 0; idx < whereParamList.length; idx++) {            whereParamList[idx] = whereParamList[idx].trim();        }    }    public int type() {        return 5;    }    public final boolean execute(TableDataTransfer tableDataTransfer) {        String columnData = tableDataTransfer.getColumnData(this.columnName);        if (columnData == null) return false;        for (int idx = 0; idx < whereParamList.length; idx++) {            if (whereParamList[idx].equals(columnData)) {                return true;            }        }        return false;    }    public final void executeAll(TableIterator iterator, TransactionNo transactionNo, List resultList) {        while (iterator.hasNext()) {            iterator.next();            TableData tableData = (TableData)iterator.getEntryValue();            TableDataTransfer tableDataTransfer = tableData.getTableDataTransfer(transactionNo);            if (tableDataTransfer != null) {                String columnData = tableDataTransfer.getColumnData(this.columnName);                if (columnData == null) continue;                for (int idx = 0; idx < whereParamList.length; idx++) {                    if (whereParamList[idx].equals(columnData)) {                        resultList.add(tableDataTransfer);                        continue;                    }                }            }        }    }}