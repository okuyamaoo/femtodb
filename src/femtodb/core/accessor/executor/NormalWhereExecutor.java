package femtodb.core.accessor.executor;import java.util.*;import femtodb.core.*;import femtodb.core.table.*;import femtodb.core.table.data.*;import femtodb.core.table.transaction.*;import femtodb.core.accessor.parameter.*;import femtodb.core.accessor.executor.*;import femtodb.core.accessor.scripts.*;/**  * NormalWhereExecutorクラス<br> * * @author Takahiro Iwase * @license Apache License 2.0  */public class NormalWhereExecutor {    private NormalWhereParameter normalWhereParameter = null;    private TableInfo tableInfo = null;    private IWhereType whereType = null;    private String targetColumnName = null;    public NormalWhereExecutor(NormalWhereParameter normalWhereParameter, TableInfo tableInfo) throws WhereExecutorCompileException {        this.normalWhereParameter = normalWhereParameter;        this.tableInfo = tableInfo;        compile();    }    private void compile() throws WhereExecutorCompileException {        try {            if (normalWhereParameter.getWhereType() == IWhereType.WHERE_TYPE_EQUAL) {                equalCompile();            } else if (normalWhereParameter.getWhereType() == IWhereType.WHERE_TYPE_LIKE) {                likeCompile();            } else if (normalWhereParameter.getWhereType() == IWhereType.WHERE_TYPE_LARGE) {                largeCompile();            } else if (normalWhereParameter.getWhereType() == IWhereType.WHERE_TYPE_SMALL) {                smallCompile();            } else if (normalWhereParameter.getWhereType() == IWhereType.WHERE_TYPE_IN) {                inCompile();            } else if (normalWhereParameter.getWhereType() == IWhereType.WHERE_TYPE_NOTIN) {                notInCompile();            }        } catch (Exception e) {            throw new WhereExecutorCompileException(e);        }    }    private void equalCompile() {        this.targetColumnName = normalWhereParameter.getColumnName();        this.whereType = new WhereTypeEqual(this.targetColumnName, normalWhereParameter.getParameter());    }    private void likeCompile() {        this.targetColumnName = normalWhereParameter.getColumnName();        this.whereType = new WhereTypeLike(this.targetColumnName, normalWhereParameter.getParameter());    }    private void largeCompile() {        this.targetColumnName = normalWhereParameter.getColumnName();        this.whereType = new WhereTypeLarge(this.targetColumnName, normalWhereParameter.getParameter());    }    private void smallCompile() {        this.targetColumnName = normalWhereParameter.getColumnName();        this.whereType = new WhereTypeSmall(this.targetColumnName, normalWhereParameter.getParameter());    }    private void inCompile() {        this.targetColumnName = normalWhereParameter.getColumnName();        this.whereType = new WhereTypeIn(this.targetColumnName, normalWhereParameter.getParameter());    }    private void notInCompile() {        this.targetColumnName = normalWhereParameter.getColumnName();        this.whereType = new WhereTypeNotIn(this.targetColumnName, normalWhereParameter.getParameter());    }    public final void execute(TableIterator iterator, TransactionNo transactionNo, List resultList) {                whereType.executeAll(iterator, transactionNo, resultList);    }    public final boolean execute(TableDataTransfer tableDataTransfer) {        return whereType.execute(tableDataTransfer);    }}